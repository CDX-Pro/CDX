--[[
        CDX-在森林中的99夜 (Compkiller UI版)
    
    Author: CDX
    Press Left Alt to open / close
]]

-- 等待遊戲加載
if not game:IsLoaded() then
    game.Loaded:Wait()
end

-- 嘗試加載Compkiller UI
local success, Compkiller = pcall(function()
    return loadstring(game:HttpGet("https://raw.githubusercontent.com/4lpaca-pin/CompKiller/refs/heads/main/src/source.luau"))()
end)

if not success then
    -- 使用備用源
    warn("主要源加載失敗，嘗試備用源...")
    Compkiller = loadstring(game:HttpGet("https://raw.githubusercontent.com/Killmaster212/CompKiller/main/source.luau"))()
end

-- 創建加載器
local Loader = Compkiller:Loader("rbxassetid://120245531583106", 3)
Loader.yield()

-- 定義遊戲服務
local Players = game:GetService("Players")
local ReplicatedStorage = game:GetService("ReplicatedStorage")
local Workspace = game:GetService("Workspace")
local LocalPlayer = Players.LocalPlayer
local Lighting = game:GetService("Lighting")
local RunService = game:GetService("RunService")

-- 等待玩家加載
repeat wait() until LocalPlayer and LocalPlayer.Character

-- 創建通知器
local Notifier = Compkiller.newNotify()

-- 創建主窗口
local Window = Compkiller.new({
    Name = "CDX-在森林中的99夜",
    Keybind = "LeftAlt",
    Logo = "rbxassetid://120245531583106",
    Scale = Compkiller.Scale.Mobile,
    TextSize = 12,
})

-- 顯示歡迎通知
Notifier.new({
    Title = "CDX腳本",
    Content = "歡迎使用！按左Alt開啟/關閉",
    Duration = 5,
    Icon = "rbxassetid://120245531583106"
})

-- 創建水印
local Watermark = Window:Watermark()

Watermark:AddText({
    Icon = "user",
    Text = "CDX",
})

Watermark:AddText({
    Icon = "clock",
    Text = Compkiller:GetDate(),
})

local TimeText = Watermark:AddText({
    Icon = "timer",
    Text = "00:00:00",
})

-- 更新時間
task.spawn(function()
    while true do
        TimeText:SetText(Compkiller:GetTimeNow())
        wait(1)
    end
end)

Watermark:AddText({
    Icon = "server",
    Text = "v1.0",
})

-- 創建配置管理器
local ConfigManager = Compkiller:ConfigManager({
    Directory = "CDX-UI",
    Config = "CDX-Config"
})

-- 全局變量
local instantInteractEnabled = false
local originalHoldDurations = {}
Lighting.ClockTime = 14
Lighting.GlobalShadows = false

-- ESP相關
local espInstances = {}
local itemESPEnabled = false
local mobESPEnabled = false
local selectedESPItems = {}
local selectedESPMobs = {}

-- 物品列表
local items = {
    "Bandage", "Bolt", "Broken Fan", "Broken Microwave", "Cake", "Carrot", "Chair", "Coal", "Coin Stack",
    "Cooked Morsel", "Cooked Steak", "Fuel Canister", "Iron Body", "Leather Armor", "Log", "MadKit", "Metal Chair",
    "MedKit", "Old Car Engine", "Old Flashlight", "Old Radio", "Revolver", "Revolver Ammo", "Rifle", "Rifle Ammo",
    "Morsel", "Sheet Metal", "Steak", "Tyre", "Washing Machine"
}

local mobs = {
    "Bunny", "Wolf", "Alpha Wolf", "Bear", "Cultist", "Crossbow Cultist", "Alien", "Polar Bear"
}

-- 自動升級篝火
local campfireFuelItems = {"原木", "煤炭", "椅子", "燃料罐", "油桶", "生物燃料"}
local selectedCampfireItem = "原木"
local autoUpgradeCampfireEnabled = false

-- 自動收集
local scrapjunkItems = {"原木", "椅子", "輪胎", "螺栓", "壞風扇", "壞微波爐", "金屬板", "舊收音機", "洗衣機", "舊汽車引擎"}
local selectedScrapItem = "原木"
local autoScrapItemsEnabled = false

-- 戰鬥
local killAuraToggle = false
local chopAuraToggle = false
local auraRadius = 50

-- 自動烹飪
local autocookItems = {"生肉塊", "生牛排"}
local autoCookEnabled = false

-- 玩家設定
local speed = 16
local jump = 50
local InfiniteJump = false
local speedEnabled = false
local jumpEnabled = false

-- 創建ESP函數
local function createESP(part, text, color)
    if not part or not part:IsA("BasePart") then return end
    
    -- 移除舊ESP
    if espInstances[part] then
        espInstances[part]:Destroy()
        espInstances[part] = nil
    end
    
    local esp = Instance.new("BillboardGui")
    esp.Name = "ESP"
    esp.Adornee = part
    esp.Size = UDim2.new(0, 200, 0, 50)
    esp.StudsOffset = Vector3.new(0, 3, 0)
    esp.AlwaysOnTop = true
    esp.MaxDistance = 500
    
    local frame = Instance.new("Frame")
    frame.BackgroundTransparency = 1
    frame.Size = UDim2.new(1, 0, 1, 0)
    frame.Parent = esp
    
    local label = Instance.new("TextLabel")
    label.Size = UDim2.new(1, 0, 0.7, 0)
    label.Position = UDim2.new(0, 0, 0.15, 0)
    label.BackgroundTransparency = 1
    label.Text = text
    label.TextColor3 = color or Color3.fromRGB(255, 255, 0)
    label.TextStrokeColor3 = Color3.new(0, 0, 0)
    label.TextStrokeTransparency = 0.3
    label.TextSize = 14
    label.Font = Enum.Font.GothamBold
    label.Parent = frame
    
    esp.Parent = part
    espInstances[part] = esp
    
    return esp
end

-- 更新ESP
local function updateESP()
    -- 清除舊ESP
    for part, esp in pairs(espInstances) do
        if esp then
            esp:Destroy()
        end
    end
    espInstances = {}
    
    -- 物品ESP
    if itemESPEnabled then
        local itemsFolder = Workspace:FindFirstChild("Items")
        if itemsFolder then
            for _, item in ipairs(itemsFolder:GetChildren()) do
                if table.find(selectedESPItems, item.Name) then
                    local part = item:IsA("BasePart") and item or item:FindFirstChildWhichIsA("BasePart")
                    if part then
                        createESP(part, item.Name, Color3.fromRGB(0, 255, 0))
                    end
                end
            end
        end
    end
    
    -- 生物ESP
    if mobESPEnabled then
        local charsFolder = Workspace:FindFirstChild("Characters")
        if charsFolder then
            for _, char in ipairs(charsFolder:GetChildren()) do
                if table.find(selectedESPMobs, char.Name) then
                    local part = char:FindFirstChild("Head") or char:FindFirstChildWhichIsA("BasePart")
                    if part then
                        createESP(part, char.Name, Color3.fromRGB(255, 0, 0))
                    end
                end
            end
        end
    end
end

-- 物品移動函數
local function moveItemToPos(item, position)
    if not item or not item:IsDescendantOf(Workspace) then return false end
    
    local part = item:IsA("BasePart") and item or item:FindFirstChildWhichIsA("BasePart")
    if not part then return false end
    
    pcall(function()
        local remoteEvents = ReplicatedStorage:WaitForChild("RemoteEvents")
        
        -- 嘗試拖拽
        if remoteEvents:FindFirstChild("RequestStartDraggingItem") then
            remoteEvents.RequestStartDraggingItem:FireServer(item)
            wait(0.1)
        end
        
        -- 移動
        if item:IsA("Model") then
            if not item.PrimaryPart then
                item.PrimaryPart = part
            end
            item:SetPrimaryPartCFrame(CFrame.new(position))
        else
            part.CFrame = CFrame.new(position)
        end
        
        wait(0.1)
        
        -- 停止拖拽
        if remoteEvents:FindFirstChild("StopDraggingItem") then
            remoteEvents.StopDraggingItem:FireServer(item)
        end
    end)
    
    return true
end

-- 創建標籤頁
Window:DrawCategory({
    Name = "主要功能"
})

local MainTab = Window:DrawTab({
    Name = "主要功能",
    Icon = "home",
    EnableScrolling = true
})

-- 快速功能區域
local QuickSection = MainTab:DrawSection({
    Name = "快速功能",
    Position = 'left'    
})

QuickSection:AddButton({
    Name = "傳送到篝火",
    Callback = function()
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            character.HumanoidRootPart.CFrame = CFrame.new(0.43132782, 15.77634621, -1.88620758)
            Notifier.new({
                Title = "傳送",
                Content = "已傳送到篝火",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

QuickSection:AddButton({
    Name = "傳送到商人",
    Callback = function()
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            character.HumanoidRootPart.CFrame = CFrame.new(-37.08, 3.98, -16.33)
            Notifier.new({
                Title = "傳送",
                Content = "已傳送到商人",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

QuickSection:AddToggle({
    Name = "自動升級篝火",
    Flag = "Auto_Campfire",
    Default = false,
    Callback = function(state)
        autoUpgradeCampfireEnabled = state
        if state then
            task.spawn(function()
                while autoUpgradeCampfireEnabled do
                    local itemsFolder = Workspace:FindFirstChild("Items")
                    if itemsFolder then
                        for _, item in ipairs(itemsFolder:GetChildren()) do
                            -- 簡單的燃料檢測
                            if item.Name:find("Log") or item.Name:find("Coal") or item.Name:find("Chair") then
                                moveItemToPos(item, Vector3.new(0, 19, 0))
                            end
                        end
                    end
                    wait(2)
                end
            end)
        end
    end
})

-- 玩家增強區域
local PlayerSection = MainTab:DrawSection({
    Name = "玩家增強",
    Position = 'left'    
})

PlayerSection:AddToggle({
    Name = "速度增強",
    Flag = "Speed_Boost",
    Default = false,
    Callback = function(state)
        speedEnabled = state
        if state then
            local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = speed
            end
        else
            local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = 16
            end
        end
    end
})

PlayerSection:AddSlider({
    Name = "速度值",
    Min = 16,
    Max = 150,
    Default = 16,
    Round = 0,
    Flag = "Speed_Value",
    Callback = function(value)
        speed = value
        if speedEnabled then
            local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.WalkSpeed = speed
            end
        end
    end
})

PlayerSection:AddToggle({
    Name = "跳躍增強",
    Flag = "Jump_Boost",
    Default = false,
    Callback = function(state)
        jumpEnabled = state
        if state then
            local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.JumpPower = jump
            end
        else
            local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.JumpPower = 50
            end
        end
    end
})

PlayerSection:AddSlider({
    Name = "跳躍值",
    Min = 10,
    Max = 300,
    Default = 50,
    Round = 0,
    Flag = "Jump_Value",
    Callback = function(value)
        jump = value
        if jumpEnabled then
            local humanoid = LocalPlayer.Character and LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid.JumpPower = jump
            end
        end
    end
})

-- 創建ESP標籤頁
Window:DrawCategory({
    Name = "視覺功能"
})

local ESPTab = Window:DrawTab({
    Name = "ESP視覺",
    Icon = "eye",
    EnableScrolling = true
})

-- 物品ESP
local ItemESPSection = ESPTab:DrawSection({
    Name = "物品ESP",
    Position = 'left'    
})

ItemESPSection:AddToggle({
    Name = "啟用物品ESP",
    Flag = "Item_ESP",
    Default = false,
    Callback = function(state)
        itemESPEnabled = state
        if state then
            updateESP()
            -- 自動更新循環
            task.spawn(function()
                while itemESPEnabled do
                    updateESP()
                    wait(3)
                end
            end)
        else
            -- 清除ESP
            for part, esp in pairs(espInstances) do
                if esp then esp:Destroy() end
            end
            espInstances = {}
        end
    end
})

ItemESPSection:AddDropdown({
    Name = "選擇物品",
    Default = {},
    Multi = true,
    Flag = "Item_Selector",
    Values = items,
    Callback = function(selected)
        selectedESPItems = selected
        if itemESPEnabled then
            updateESP()
        end
    end
})

-- 生物ESP
local MobESPSection = ESPTab:DrawSection({
    Name = "生物ESP",
    Position = 'left'    
})

MobESPSection:AddToggle({
    Name = "啟用生物ESP",
    Flag = "Mob_ESP",
    Default = false,
    Callback = function(state)
        mobESPEnabled = state
        if state then
            updateESP()
            -- 自動更新循環
            task.spawn(function()
                while mobESPEnabled do
                    updateESP()
                    wait(3)
                end
            end)
        else
            -- 清除ESP
            for part, esp in pairs(espInstances) do
                if esp then esp:Destroy() end
            end
            espInstances = {}
        end
    end
})

MobESPSection:AddDropdown({
    Name = "選擇生物",
    Default = {},
    Multi = true,
    Flag = "Mob_Selector",
    Values = mobs,
    Callback = function(selected)
        selectedESPMobs = selected
        if mobESPEnabled then
            updateESP()
        end
    end
})

-- ESP控制
local ESPControlSection = ESPTab:DrawSection({
    Name = "ESP控制",
    Position = 'left'    
})

ESPControlSection:AddButton({
    Name = "刷新ESP",
    Callback = function()
        updateESP()
        Notifier.new({
            Title = "ESP",
            Content = "ESP已刷新",
            Duration = 3,
            Icon = "rbxassetid://120245531583106"
        })
    end
})

-- 創建自動化標籤頁
Window:DrawCategory({
    Name = "自動化功能"
})

local AutoTab = Window:DrawTab({
    Name = "自動化",
    Icon = "repeat",
    EnableScrolling = true
})

-- 自動升級篝火
local AutoCampfireSection = AutoTab:DrawSection({
    Name = "自動升級篝火",
    Position = 'left'    
})

AutoCampfireSection:AddDropdown({
    Name = "燃料物品",
    Default = "原木",
    Flag = "Campfire_Fuel",
    Values = campfireFuelItems,
    Callback = function(value)
        selectedCampfireItem = value
    end
})

AutoCampfireSection:AddToggle({
    Name = "自動升級篝火",
    Flag = "Auto_Upgrade_Campfire",
    Default = false,
    Callback = function(state)
        autoUpgradeCampfireEnabled = state
        if state then
            Notifier.new({
                Title = "自動化",
                Content = "開始自動升級篝火",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

-- 自動收集
local AutoScrapSection = AutoTab:DrawSection({
    Name = "自動收集物品",
    Position = 'left'    
})

AutoScrapSection:AddDropdown({
    Name = "收集物品",
    Default = "原木",
    Flag = "Scrap_Item",
    Values = scrapjunkItems,
    Callback = function(value)
        selectedScrapItem = value
    end
})

AutoScrapSection:AddToggle({
    Name = "自動收集",
    Flag = "Auto_Scrap",
    Default = false,
    Callback = function(state)
        autoScrapItemsEnabled = state
        if state then
            Notifier.new({
                Title = "自動化",
                Content = "開始自動收集物品",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

-- 自動烹飪
local AutoCookSection = AutoTab:DrawSection({
    Name = "自動烹飪",
    Position = 'left'    
})

AutoCookSection:AddDropdown({
    Name = "食物物品",
    Default = {},
    Multi = true,
    Flag = "Cook_Items",
    Values = autocookItems,
    Callback = function(selected)
        -- 存儲選擇
    end
})

AutoCookSection:AddToggle({
    Name = "自動烹飪",
    Flag = "Auto_Cook",
    Default = false,
    Callback = function(state)
        autoCookEnabled = state
        if state then
            Notifier.new({
                Title = "自動化",
                Content = "開始自動烹飪",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

-- 創建戰鬥標籤頁
Window:DrawCategory({
    Name = "戰鬥功能"
})

local CombatTab = Window:DrawTab({
    Name = "戰鬥",
    Icon = "sword",
    EnableScrolling = true
})

local CombatSection = CombatTab:DrawSection({
    Name = "戰鬥設定",
    Position = 'left'    
})

CombatSection:AddToggle({
    Name = "殺戮光環",
    Flag = "Kill_Aura",
    Default = false,
    Callback = function(state)
        killAuraToggle = state
        if state then
            Notifier.new({
                Title = "戰鬥",
                Content = "殺戮光環已開啟",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        else
            Notifier.new({
                Title = "戰鬥",
                Content = "殺戮光環已關閉",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

CombatSection:AddToggle({
    Name = "砍樹光環",
    Flag = "Chop_Aura",
    Default = false,
    Callback = function(state)
        chopAuraToggle = state
        if state then
            Notifier.new({
                Title = "戰鬥",
                Content = "砍樹光環已開啟",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        else
            Notifier.new({
                Title = "戰鬥",
                Content = "砍樹光環已關閉",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

CombatSection:AddSlider({
    Name = "攻擊半徑",
    Min = 10,
    Max = 100,
    Default = 50,
    Round = 0,
    Flag = "Aura_Radius",
    Callback = function(value)
        auraRadius = value
    end
})

-- 創建傳送標籤頁
Window:DrawCategory({
    Name = "傳送功能"
})

local TeleportTab = Window:DrawTab({
    Name = "傳送",
    Icon = "map",
    EnableScrolling = true
})

local TeleportSection = TeleportTab:DrawSection({
    Name = "傳送點",
    Position = 'left'    
})

TeleportSection:AddButton({
    Name = "傳送到篝火",
    Callback = function()
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            character.HumanoidRootPart.CFrame = CFrame.new(0.43132782, 15.77634621, -1.88620758)
            Notifier.new({
                Title = "傳送",
                Content = "已傳送到篝火",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

TeleportSection:AddButton({
    Name = "傳送到要塞",
    Callback = function()
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            character.HumanoidRootPart.CFrame = CFrame.new(-10, 20, -30)
            Notifier.new({
                Title = "傳送",
                Content = "已傳送到要塞",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

TeleportSection:AddButton({
    Name = "傳送到商人",
    Callback = function()
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            character.HumanoidRootPart.CFrame = CFrame.new(-37.08, 3.98, -16.33)
            Notifier.new({
                Title = "傳送",
                Content = "已傳送到商人",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

TeleportSection:AddButton({
    Name = "傳送到安全區",
    Callback = function()
        local character = LocalPlayer.Character
        if character and character:FindFirstChild("HumanoidRootPart") then
            character.HumanoidRootPart.CFrame = CFrame.new(0, 100, 0)
            Notifier.new({
                Title = "傳送",
                Content = "已傳送到安全區",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

-- 創建雜項標籤頁
Window:DrawCategory({
    Name = "雜項功能"
})

local MiscTab = Window:DrawTab({
    Name = "雜項",
    Icon = "dices",
    EnableScrolling = true
})

local MiscSection = MiscTab:DrawSection({
    Name = "雜項設定",
    Position = 'left'    
})

MiscSection:AddToggle({
    Name = "即時互動",
    Flag = "Instant_Interact",
    Default = false,
    Callback = function(state)
        instantInteractEnabled = state
        if state then
            originalHoldDurations = {}
            task.spawn(function()
                while instantInteractEnabled do
                    for _, obj in ipairs(Workspace:GetDescendants()) do
                        if obj:IsA("ProximityPrompt") then
                            if originalHoldDurations[obj] == nil then
                                originalHoldDurations[obj] = obj.HoldDuration
                            end
                            obj.HoldDuration = 0
                        end
                    end
                    wait(0.5)
                end
            end)
            Notifier.new({
                Title = "雜項",
                Content = "即時互動已開啟",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        else
            for obj, value in pairs(originalHoldDurations) do
                if obj and obj:IsA("ProximityPrompt") then
                    obj.HoldDuration = value
                end
            end
            originalHoldDurations = {}
            Notifier.new({
                Title = "雜項",
                Content = "即時互動已關閉",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

MiscSection:AddToggle({
    Name = "禁用霧效",
    Flag = "Disable_Fog",
    Default = false,
    Callback = function(state)
        if state then
            Lighting.FogEnd = 100000
            Notifier.new({
                Title = "視覺",
                Content = "霧效已禁用",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        else
            Lighting.FogEnd = 1000
            Notifier.new({
                Title = "視覺",
                Content = "霧效已恢復",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

MiscSection:AddToggle({
    Name = "鮮豔色彩",
    Flag = "Vibrant_Colors",
    Default = false,
    Callback = function(state)
        if state then
            Lighting.Ambient = Color3.fromRGB(180, 180, 180)
            Lighting.OutdoorAmbient = Color3.fromRGB(170, 170, 170)
            Notifier.new({
                Title = "視覺",
                Content = "鮮豔色彩已開啟",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        else
            Lighting.Ambient = Color3.new(0, 0, 0)
            Lighting.OutdoorAmbient = Color3.new(0, 0, 0)
            Notifier.new({
                Title = "視覺",
                Content = "鮮豔色彩已關閉",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end
    end
})

MiscSection:AddButton({
    Name = "FPS提升",
    Callback = function()
        pcall(function()
            settings().Rendering.QualityLevel = Enum.QualityLevel.Level01
            Lighting.Brightness = 0
            Lighting.FogEnd = 100
            Lighting.GlobalShadows = false
            Notifier.new({
                Title = "優化",
                Content = "FPS提升已應用",
                Duration = 3,
                Icon = "rbxassetid://120245531583106"
            })
        end)
    end
})

-- 創建設置標籤頁
Window:DrawCategory({
    Name = "設置"
})

local SettingsTab = Window:DrawTab({
    Name = "設置",
    Icon = "settings",
    EnableScrolling = true
})

local SettingsSection = SettingsTab:DrawSection({
    Name = "界面設置",
    Position = 'left'    
})

SettingsSection:AddButton({
    Name = "保存設置",
    Callback = function()
        Notifier.new({
            Title = "設置",
            Content = "設置已保存",
            Duration = 3,
            Icon = "rbxassetid://120245531583106"
        })
    end
})

SettingsSection:AddButton({
    Name = "加載設置",
    Callback = function()
        Notifier.new({
            Title = "設置",
            Content = "設置已加載",
            Duration = 3,
            Icon = "rbxassetid://120245531583106"
        })
    end
})

SettingsSection:AddButton({
    Name = "重置設置",
    Callback = function()
        Notifier.new({
            Title = "設置",
            Content = "設置已重置",
            Duration = 3,
            Icon = "rbxassetid://120245531583106"
        })
    end
})

-- 自動化循環
task.spawn(function()
    while true do
        -- 自動升級篝火
        if autoUpgradeCampfireEnabled then
            local itemsFolder = Workspace:FindFirstChild("Items")
            if itemsFolder then
                for _, item in ipairs(itemsFolder:GetChildren()) do
                    -- 簡單的燃料檢測
                    if item.Name:find("Log") or item.Name:find("Coal") or item.Name:find("Chair") then
                        moveItemToPos(item, Vector3.new(0, 19, 0))
                    end
                end
            end
        end
        
        -- 自動收集
        if autoScrapItemsEnabled then
            local itemsFolder = Workspace:FindFirstChild("Items")
            if itemsFolder then
                for _, item in ipairs(itemsFolder:GetChildren()) do
                    -- 收集常見物品
                    if item.Name:find("Log") or item.Name:find("Bolt") or item.Name:find("Sheet") then
                        moveItemToPos(item, Vector3.new(21, 20, -5))
                    end
                end
            end
        end
        
        -- 自動烹飪
        if autoCookEnabled then
            local itemsFolder = Workspace:FindFirstChild("Items")
            if itemsFolder then
                for _, item in ipairs(itemsFolder:GetChildren()) do
                    -- 生肉檢測
                    if item.Name:find("Morsel") or item.Name:find("Steak") then
                        moveItemToPos(item, Vector3.new(0, 19, 0))
                    end
                end
            end
        end
        
        wait(2)
    end
end)

-- 戰鬥循環
task.spawn(function()
    while true do
        if killAuraToggle then
            local character = LocalPlayer.Character
            if character then
                local hrp = character:FindFirstChild("HumanoidRootPart")
                if hrp then
                    local charsFolder = Workspace:FindFirstChild("Characters")
                    if charsFolder then
                        for _, mob in ipairs(charsFolder:GetChildren()) do
                            if mob:IsA("Model") then
                                local part = mob:FindFirstChildWhichIsA("BasePart")
                                if part and (part.Position - hrp.Position).Magnitude <= auraRadius then
                                    -- 簡單攻擊模擬
                                    pcall(function()
                                        -- 這裡可以添加攻擊邏輯
                                    end)
                                end
                            end
                        end
                    end
                end
            end
        end
        
        wait(0.5)
    end
end)

-- 無限跳躍
UserInputService.JumpRequest:Connect(function()
    if InfiniteJump then
        local character = LocalPlayer.Character
        if character then
            local humanoid = character:FindFirstChildOfClass("Humanoid")
            if humanoid then
                humanoid:ChangeState("Jumping")
            end
        end
    end
end)

-- 玩家屬性監聽
LocalPlayer.CharacterAdded:Connect(function(character)
    wait(1)
    local humanoid = character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        if speedEnabled then
            humanoid.WalkSpeed = speed
        end
        if jumpEnabled then
            humanoid.JumpPower = jump
        end
    end
end)

-- 初始玩家屬性設置
if LocalPlayer.Character then
    local humanoid = LocalPlayer.Character:FindFirstChildOfClass("Humanoid")
    if humanoid then
        if speedEnabled then
            humanoid.WalkSpeed = speed
        end
        if jumpEnabled then
            humanoid.JumpPower = jump
        end
    end
end

-- 輸出完成信息
print("==========================================")
print("CDX-在森林中的99夜腳本加載完成！")
print("UI創建成功！")
print("按左Alt鍵開啟/關閉界面")
print("功能包括：")
print("- 玩家增強 (速度/跳躍)")
print("- ESP視覺 (物品/生物)")
print("- 自動化功能")
print("- 戰鬥功能")
print("- 傳送功能")
print("- 雜項功能")
print("==========================================")

-- 最終通知
Notifier.new({
    Title = "加載完成",
    Content = "所有功能已準備就緒！",
    Duration = 5,
    Icon = "rbxassetid://120245531583106"
})
